<section id="projects" class="content-section">
  <div class="container">
    <h2>My Projects</h2>
    <div class="project-grid">
      <div class="project-card"
        *ngFor="let project of displayedProjects; let i = index">
        <img class="project-image"
          [src]="project.imageUrl"
          [alt]="project.title + ' Screenshot'"
          (click)="showImageInLightbox(project.imageUrl)"
          (error)="handleImageError($event)">
        <h4>{{ project.title }} ({{ project.year }})</h4>
        <button class="btn outline details-button"
          (click)="toggleDetails(project)"
          [attr.aria-expanded]="project.isExpanded"
          [attr.aria-controls]="project.id">
          {{ project.isExpanded ? 'Hide Details' : 'Show Details' }}
        </button>
        <div class="project-details-collapsible"
          [id]="project.id"
          [@expandCollapse]="project.isExpanded ? 'true' : 'false'">
          <p class="project-role"><strong>Role:</strong> {{ project.role }}</p>
          <ul class="project-details">
            <li *ngFor="let detail of project.details">{{ detail }}</li>
          </ul>
          <div class="project-links">
            <a [href]="project.githubUrl"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link-button">
              View on GitHub
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="show-all-container" *ngIf="shouldShowLoadMoreButton">
      <button class="btn outline" (click)="loadAllProjects()">
        All Projects
      </button>
    </div>
  </div>
</section>

<div class="lightbox-overlay"
  *ngIf="selectedImageUrl"
  (click)="closeLightbox()"
  [@fadeInOut]>
  <div class="lightbox-content" (click)="$event.stopPropagation()">
    <button class="lightbox-close" (click)="closeLightbox()"
      aria-label="Close image view">Ã—</button>
    <img [src]="selectedImageUrl" alt="Enlarged project image">
  </div>
</div>
